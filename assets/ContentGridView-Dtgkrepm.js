import{j as e}from"./jsx-runtime-D_zvdyIk.js";import{a as i}from"./chunk-QMGIS6GS-npKyu-26.js";import{i as G,j as v}from"./content-D7L0e-wr.js";import{G as y,f as O,m as _,F as z,e as C}from"./layout-CG8-yu9n.js";import{d as F,B as A,T as l}from"./TextInput-DMku8_7E.js";import{I as D,S as B,d as M,j as N,i as H,h as V,g as X,f as k,u as P,C as Q}from"./ContentAddModal-C_1kSIvW.js";import{C as T,B as I}from"./react-Bl1EszzN.js";const U=i.memo(()=>{const[t,h]=T(G),[u,m]=T(v),a=r=>{switch(r){case"all":return e.jsx(M,{size:14});case"video":return e.jsx(k,{size:14});case"image":return e.jsx(X,{size:14});case"text":return e.jsx(V,{size:14});case"youtube":return e.jsx(H,{size:14});case"url":return e.jsx(N,{size:14});case"unused":return e.jsx(_,{size:14});default:return e.jsx(M,{size:14})}},p=r=>{switch(r){case"all":return"すべて";case"video":return"動画";case"image":return"画像";case"text":return"テキスト";case"youtube":return"YouTube";case"url":return"URL";case"unused":return"未使用";default:return"すべて"}},n=r=>({value:r,label:e.jsxs(y,{gap:4,align:"center",justify:"center",miw:"80px",wrap:"nowrap",children:[a(r),e.jsx(l,{size:"xs",style:{whiteSpace:"nowrap"},children:p(r)})]})}),f=[n("all"),n("video"),n("image"),n("text"),n("youtube"),n("url"),n("unused")];return e.jsxs(y,{gap:"md",mb:"md",children:[e.jsx(F,{placeholder:"コンテンツを検索...","aria-label":"コンテンツを検索",leftSection:e.jsx(D,{size:16}),rightSection:u?e.jsx(A,{variant:"subtle",size:"xs",p:0,onClick:()=>m(""),miw:"auto",h:"auto","aria-label":"検索をクリア",children:e.jsx(O,{size:14})}):null,value:u,onChange:r=>m(r.target.value),flex:1,miw:200}),e.jsx(B,{value:t,onChange:r=>h(r),data:f,size:"sm","aria-label":"コンテンツタイプフィルター",miw:"520px",fullWidth:!1})]})});U.displayName="ContentFilters";const g={XL:1200,LG:992,MD:768,SM:576},x={XL:{cols:6,spacing:"md"},LG:{cols:5,spacing:"md"},MD:{cols:4,spacing:"sm"},SM:{cols:3,spacing:"sm"},XS:{cols:2,spacing:"xs"}},L=24,w=12,Y="100px",$=.1,K="300px",q="20px",J=t=>t>=g.XL?x.XL:t>=g.LG?x.LG:t>=g.MD?x.MD:t>=g.SM?x.SM:x.XS,Z=i.memo(({contents:t,onContentClick:h,onContentEdit:u,onContentDelete:m,loading:a=!1})=>{const{width:p}=P(),[n,f]=i.useState([]),[r,b]=i.useState(!0),c=i.useRef(null),j=i.useRef(null),o=i.useMemo(()=>J(p),[p]);i.useEffect(()=>{f(t.slice(0,L)),b(t.length>L)},[t]);const R=i.useCallback(()=>{const s=n.length,d=t.slice(s,s+w);d.length>0&&f(S=>[...S,...d]),s+d.length>=t.length&&b(!1)},[t,n.length]);i.useEffect(()=>(c.current&&c.current.disconnect(),c.current=new IntersectionObserver(s=>{s[0].isIntersecting&&r&&!a&&R()},{rootMargin:Y,threshold:$}),j.current&&c.current.observe(j.current),()=>{c.current&&c.current.disconnect()}),[r,a,R]);const E=s=>{h?h(s):(s.type==="youtube"||s.type==="url")&&s.url&&window.open(s.url,"_blank","noopener,noreferrer")};return t.length===0&&!a?e.jsx(z,{align:"center",justify:"center",mih:K,ta:"center",children:e.jsxs("div",{children:[e.jsx(l,{size:"lg",c:"dimmed",mb:"sm",children:"コンテンツがありません"}),e.jsx(l,{size:"sm",c:"dimmed",children:"ファイルをアップロードするか、URLを追加してください"})]})}):e.jsxs(I,{children:[e.jsx(C,{cols:o.cols,spacing:o.spacing,verticalSpacing:o.spacing,children:n.map(s=>e.jsx(Q,{content:s,onClick:()=>E(s),onEdit:u?()=>u(s):void 0,onDelete:m?()=>m(s):void 0},s.id))}),r&&e.jsx(I,{ref:j,h:q,mt:"20px",children:e.jsx(l,{ta:"center",size:"sm",c:"dimmed",children:a?"読み込み中...":""})}),a&&r&&e.jsx(C,{cols:o.cols,spacing:o.spacing,verticalSpacing:o.spacing,mt:"md",children:Array.from({length:w},(s,d)=>{const S=`loading-skeleton-${Date.now()}-${Math.random()}-${d}`;return e.jsx(z,{w:"100%",bg:"gray.1",style:{borderRadius:"4px",aspectRatio:(16/9).toString()},align:"center",justify:"center",children:e.jsx(l,{size:"xs",c:"dimmed",children:"読み込み中..."})},S)})}),!r&&n.length>0&&e.jsx(I,{mt:"xl",mb:"md",children:e.jsxs(l,{ta:"center",size:"sm",c:"dimmed",children:["全 ",t.length," 件のコンテンツを表示しました"]})})]})});Z.displayName="ContentGridView";export{U as C,Z as a};
